<ion-header>
	<ion-icon (click)="goHome()" class='homeIcon' name="md-home"></ion-icon>
	<h1 (click)="goHome()" id="ptitle">Timmerdorp 2019</h1>
	<ion-navbar>
		<ion-title>
			<img (click)="goHome()" src="assets/imgs/logo.png" class="nav-logo">
		</ion-title>
	</ion-navbar>
</ion-header>

<ion-content padding>
	<div class="user-info">
		<span *ngIf="!loginError&&!notLoggedIn" style="color:red;font-weight:bold">
			{{error}}
		</span>
		<span *ngIf="loginError" style="color:red;font-weight:bold">
			Login-gegevens onjuist. <a (click)='toLogin()'>Aanpassen</a>
		</span>
		<span *ngIf="notLoggedIn" style="color:red;font-weight:bold">
			Je moet eerst <a (click)='toLogin()'>inloggen</a>!
		</span>
		<div style='height: 20px;'>
			<div *ngIf="loading&&!notLoggedIn">
				Laden...
			</div>
		</div>
	</div>
	<div class="user-info">
		<h1>Hutnummer:</h1>
		<ion-input #nrInput type="tel" placeholder="123" [(ngModel)]="hutNr" (ngModelChange)="search($event)"
			maxlength="3"></ion-input>
	</div>
	<div class="bracelet-number">
		<h1>Kinderen in hut{{hutNr?' ' + hutNr:''}}:</h1>
		<div *ngFor="let child of hutTickets">
			<button ion-button full class="bg-grey color-mediumBlack" (click)="removeChild = child; showRemoveModal();">
				{{ child.meta.WooCommerceEventsAttendeeName[0] }} {{ child.meta.WooCommerceEventsAttendeeLastName[0] }} ({{ child.meta.wristband ||
				'-' }})
			</button>
		</div>
		<button ion-button full (click)="showAddModal()" [ngClass]='hutNr && hutNr.length === 3 ? "shown":""'
			class="conditional bg-blue correction">
			Kind toevoegen
		</button>
		<!-- Trigger/Open The Modal -->

		<div [ngClass]="{'shown': addModal.show}" (click)="$event.target.id==='myModal'?closeAddModal():''" id="myModal"
			class="modal conditional">
			<div class="modal-content">
				<span class="close" (click)="closeAddModal()">&times;</span>
				<h1>Zoek een kind en voeg het toe</h1>
				<span style="color:red;">
					{{searchError}}
				</span>
				<ion-input type="text" placeholder='Nummer of naam van kind' [(ngModel)]="searchTerm"
					(ngModelChange)="searchChild($event)"></ion-input>
				<div *ngFor="let child of tickets">
					<button ion-button full (click)="addChildToHut(child);closeAddModal()"
						class="bg-grey color-mediumBlack">
						{{ child.meta.WooCommerceEventsAttendeeName[0] }}
						{{ child.meta.WooCommerceEventsAttendeeLastName[0] }} ({{ child.meta.wristband ||
						'-' }})&nbsp;{{child.meta.hutnr[0]?"&mdash;&nbsp;":''}}
						<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '0'"
							style="background-color:yellow;padding: 0px 6px">hutnummer:&nbsp;
							{{ child.meta.hutnr}}</span>
						<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '1'"
							style="background-color:red;color:white;padding: 0px 6px">hutnummer:&nbsp;
							{{ child.meta.hutnr }}</span>
						<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '2'"
							style="background-color:blue;color:white;padding: 0px 6px">hutnummer:&nbsp;
							{{ child.meta.hutnr }}</span>
						<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '3'"
							style="background-color:green;color:white;padding: 0px 6px">hutnummer:&nbsp;
							{{ child.meta.hutnr}}</span>
					</button>
				</div>

			</div>

		</div>

		<div [ngClass]="{'shown': removeModal.show}" id="removeModal"
			(click)="$event.target.id==='removeModal'?closeRemoveModal():''" class="conditional modal stanModal">
			<div class="modal-content">
				<span class="close" (click)="closeRemoveModal()">&times;</span>
				<h1 *ngIf="removeChild">Weet je zeker dat je {{ removeChild.meta.WooCommerceEventsAttendeeName[0] }}
					wilt verwijderen?</h1>
				<button ion-button full (click)="removeChildFromHut(removeChild)"
					class="bg-green correction">Ja</button>
				<button ion-button full (click)="closeRemoveModal()" class="bg-red correction">Nee</button>
			</div>
		</div>
	</div>
</ion-content>
