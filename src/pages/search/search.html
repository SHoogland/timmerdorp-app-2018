<ion-header>
	<h1 click="navCtrl.setRoot(HomePage)" id="ptitle">Timmerdorp 2019</h1>
	<ion-navbar>
		<button ion-button menuToggle>
			<ion-icon name='menu'></ion-icon>
		</button>
		<ion-title>
			<img src="assets/imgs/logo.png"
				click="navCtrl.setRoot(HomePage)"
				 class="nav-logo">
		</ion-title>
	</ion-navbar>
</ion-header>

<ion-content padding>
	<div class="user-info">
		<span *ngIf="!loginError&&!notLoggedIn" style="color:red;font-weight:bold">
			{{error}}
		</span>
		<span *ngIf="loginError" style="color:red;font-weight:bold">
			Login-gegevens onjuist. <a (click)='toLogin()'>Aanpassen</a>
		</span>
		<span *ngIf="notLoggedIn" style="color:red;font-weight:bold">
			Je moet eerst <a (click)='toLogin()'>inloggen</a>!
		</span>
		<div style='height: 20px;'>
			<div *ngIf="loading&&!notLoggedIn">
				Laden...
			</div>
		</div>
	</div>
	<div class="container">
		<div class="bracelet-number">
			<h1>Zoek kind:</h1>
			<span class="search-on">Zoek op naam, armbandnummer of hutnummer</span>
			<ion-input type="text" [(ngModel)]="searchTerm" (ngModelChange)="search($event)"></ion-input>
		</div>
	</div>
	<div *ngFor="let child of tickets">
		<button ion-button full (click)="showModal(child)" class="bg-grey color-mediumBlack">
			{{child.meta.WooCommerceEventsAttendeeName[0]}} {{child.meta.WooCommerceEventsAttendeeLastName[0]}} ({{child.meta.wristband ||
			'-'}})&nbsp;&nbsp;
			<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '0'"
				style="background-color:yellow;padding: 2px 6px">(hutnummer:&nbsp; {{child.meta.hutnr}})</span>
			<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '1'"
				style="background-color:red;color:white;padding: 2px 6px">(hutnummer:&nbsp;
				{{child.meta.hutnr}})</span>
			<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '2'"
				style="background-color:blue;color:white;padding: 2px 6px">(hutnummer:&nbsp;
				{{child.meta.hutnr}})</span>
			<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '3'"
				style="background-color:green;color:white;padding: 2px 6px">(hutnummer:&nbsp;
				{{child.meta.hutnr}})</span>
		</button>
	</div>

	<!-- start modal box -->
	<div *ngIf="modal.showModal" id="myModal" (click)="$event.target.id==='myModal'?modal.showModal=false:''"
		class="modal">
		<div class="modal-content">
			<span class="close" (click)="modal.showModal = false;">&times;</span>
			<h1 id='childDataHeader'>Gegevens</h1>
			<table>
				<tr>
					<td class='b'>Voornaam</td>
					<td>{{modal.child.meta.WooCommerceEventsAttendeeName[0]}}</td>
				</tr>
				<tr>
					<td class='b'>Achternaam</td>
					<td>{{modal.child.meta.WooCommerceEventsAttendeeLastName[0]}}</td>
				</tr>
				<tr>
					<td class='b'>Geboortedatum</td>
					<td>{{modal.child.meta['fooevents_custom_geboortedatum_(dd-mm-jjjj)'][0]}}</td>
				</tr>
				<tr>
					<td class='b'>Huisarts</td>
					<td>{{(modal.child.meta.fooevents_custom_naam_huisarts||[])[0]}}</td>
				</tr>
				<tr>
					<td class='b'>Opmerkingen</td>
					<td>{{(modal.child.meta['fooevents_custom_opmerkingen,_allergien']||[])[0]}}</td>
				</tr>
				<tr>
					<td class='b'>Tel. huisarts</td>
					<td><a
							href="tel: {{modal.child.meta.fooevents_custom_telefoonnr_huisarts[0]}}">{{modal.child.meta.fooevents_custom_telefoonnr_huisarts[0]}}</a>
					</td>
				</tr>
				<tr>
					<td class='b'>Tel. ouder 1</td>
					<td><a
							href="tel: {{modal.child.meta.fooevents_custom_telefoonnr_ouders[0]}}">{{modal.child.meta.fooevents_custom_telefoonnr_ouders[0]}}</a>
					</td>
				</tr>
				<tr>
					<td class='b'>Tel. ouder 2</td>
					<td><a
							href="tel: {{modal.child.meta['fooevents_custom_telefoonnr_ouders_(2)'][0]}}">{{modal.child.meta['fooevents_custom_telefoonnr_ouders_(2)'][0]}}</a>
					</td>
				</tr>
				<tr>
					<td class='b'>E-mailadres</td>
					<td>{{modal.child.meta.WooCommerceEventsPurchaserEmail[0]}}</td>
				</tr>
				<tr>
					<td class='b'>Bandje</td>
					<td>
						<div *ngIf="modal.child.meta.wristband">{{modal.child.meta.wristband[0]}}</div>
					</td>
				</tr>
				<tr>
					<td class='b'>Hutnummer</td>
					<td>
						<div *ngIf="modal.child.meta.hutnr">{{modal.child.meta.hutnr[0]}}</div>
					</td>
				</tr>
				<tr>
					<td class='b'>Woensdag</td>
					<td>
						<div *ngIf="modal.child.meta.present_wed">Aanwezig</div>
						<div *ngIf="!modal.child.meta.present_wed">Afwezig</div>
					</td>
				</tr>
				<tr>
					<td class='b'>Donderdag</td>
					<td>
						<div *ngIf="modal.child.meta.present_thu">Aanwezig</div>
						<div *ngIf="!modal.child.meta.present_thu">Afwezig</div>
					</td>
				</tr>
			</table>
			<button ion-button full (click)="modal.showModal = false;" class="bg-green correction">Ok</button>
			<button ion-button full (click)="scanChild(modal.child.meta.WooCommerceEventsTicketID[0])"
				class="bg-yellow correction">Scan</button>
			<button ion-button full (click)="goBack()" class="bg-red correction">Terug naar homepagina</button>
		</div>
	</div>
</ion-content>