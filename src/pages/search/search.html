<ion-header>
	<ion-icon (click)="goHome()" class='homeIcon' name="md-home"></ion-icon>
	<h1 (click)="goHome()" id="ptitle">Timmerdorp</h1>
	<ion-navbar>
		<ion-title>
			<img (click)="goHome()" src="assets/imgs/logo.png" class="nav-logo">
		</ion-title>
	</ion-navbar>
</ion-header>

<ion-content padding>
	<div class="user-info">
		<span *ngIf="!loginError&&!notLoggedIn" style="color:red;font-weight:bold">
			{{error}}
		</span>
		<span *ngIf="loginError" style="color:red;font-weight:bold">
			Login-gegevens onjuist. <a (click)='toLogin()'>Aanpassen</a>
		</span>
		<span *ngIf="notLoggedIn" style="color:red;font-weight:bold">
			Je moet eerst <a (click)='toLogin()'>inloggen</a>!
		</span>
		<div style='height: 20px;'>
			<div *ngIf="loading&&!notLoggedIn">
				Laden...
			</div>
		</div>
	</div>
	<div class="container">
		<div class="bracelet-number">
			<h1>Zoek kind:</h1>
			<span class="search-on">Zoek op naam, armbandnummer of hutnummer</span>
			<ion-item>
				<ion-input type="text" [(ngModel)]="searchTerm" (ngModelChange)="search($event)"></ion-input>
			</ion-item>
		</div>
	</div>
	<div *ngFor="let child of tickets">
		<button ion-button full (click)="showModal(child)" class="bg-grey color-mediumBlack">
			{{child.meta.WooCommerceEventsAttendeeName[0]}} {{child.meta.WooCommerceEventsAttendeeLastName[0]}} ({{child.meta.wristband ||
			'-'}})&nbsp;&nbsp;
			<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '0'"
				style="background-color:yellow;padding: 2px 6px">(hutnummer:&nbsp; {{child.meta.hutnr}})</span>
			<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '1'"
				style="background-color:red;color:white;padding: 2px 6px">(hutnummer:&nbsp;
				{{child.meta.hutnr}})</span>
			<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '2'"
				style="background-color:blue;color:white;padding: 2px 6px">(hutnummer:&nbsp;
				{{child.meta.hutnr}})</span>
			<span *ngIf="child.meta.hutnr && child.meta.hutnr[0][0] === '3'"
				style="background-color:green;color:white;padding: 2px 6px">(hutnummer:&nbsp;
				{{child.meta.hutnr}})</span>
		</button>
	</div>

	<!-- start modal box -->
	<div [ngClass]="{'shown': modal.showModal}" (click)="$event.target.id==='myModal'?closeModal():''" id="myModal"
		class="modal conditional">
		<div class="modal-content" *ngIf="modal.child">
			<span class="close" (click)="closeModal();">&times;</span>
			<h1 id='childDataHeader'>Gegevens</h1>
			<table>
				<tr>
					<td class='b'>Voornaam</td>
					<td>{{modal.child.meta.WooCommerceEventsAttendeeName[0]}}</td>
				</tr>
				<tr>
					<td class='b'>Achternaam</td>
					<td>{{modal.child.meta.WooCommerceEventsAttendeeLastName[0]}}</td>
				</tr>
				<tr>
					<td class='b'>Geboortedatum</td>
					<td>{{modal.child.meta['fooevents_custom_geboortedatum_(dd-mm-jjjj)'][0]}}</td>
				</tr>
				<tr>
					<td class='b'>Huisarts</td>
					<td>{{(modal.child.meta.fooevents_custom_naam_huisarts||[])[0]}}</td>
				</tr>
				<tr>
					<td class='b'>Opmerkingen</td>
					<td>{{(modal.child.meta['fooevents_custom_opmerkingen,_allergien']||[])[0]}}</td>
				</tr>
				<tr>
					<td class='b'>Tel. huisarts</td>
					<td><a
							href="tel: {{filterPhoneNr(modal.child.meta.fooevents_custom_telefoonnr_huisarts)}}">{{modal.child.meta.fooevents_custom_telefoonnr_huisarts[0]}}</a>
					</td>
				</tr>
				<tr>
					<td class='b'>Tel. ouder 1</td>
					<td><a
							href="tel: {{filterPhoneNr(modal.child.meta.fooevents_custom_telefoonnr_ouders)}}">{{modal.child.meta.fooevents_custom_telefoonnr_ouders[0]}}</a>
					</td>
				</tr>
				<tr>
					<td class='b'>Tel. ouder 2</td>
					<td><a
							href="tel: {{filterPhoneNr(modal.child.meta['fooevents_custom_telefoonnr_ouders_(2)'])}}">{{modal.child.meta['fooevents_custom_telefoonnr_ouders_(2)'][0]}}</a>
					</td>
				</tr>
				<tr>
					<td class='b'>E-mailadres</td>
					<td>{{modal.child.meta.WooCommerceEventsPurchaserEmail[0]}}</td>
				</tr>
				<tr>
					<td class='b'>Bandje</td>
					<td>
						<div *ngIf="modal.child.meta.wristband">{{modal.child.meta.wristband[0]}}</div>
					</td>
				</tr>
				<tr>
					<td class='b'>Hutnummer</td>
					<td>
						<div *ngIf="modal.child.meta.hutnr">{{modal.child.meta.hutnr[0]}}</div>
					</td>
				</tr>
				<tr>
					<td class='b'>Wijk</td>
					<td>
						<div *ngIf="modal.child.meta.hutnr">{{getWijk(modal.child.meta.hutnr[0])}}</div>
					</td>
				</tr>
				<tr>
					<td class='b'>Dinsdag</td>
					<td>
						{{(modal.child.meta.present_tue||[])[0] === '1'?"Aanwezig":"Afwezig"}}
					</td>
				</tr>
				<tr>
					<td class='b'>Woensdag</td>
					<td>
						{{(modal.child.meta.present_wed||[])[0] === '1'?"Aanwezig":"Afwezig"}}
					</td>
				</tr>
				<tr>
					<td class='b'>Donderdag</td>
					<td>
						{{(modal.child.meta.present_thu||[])[0] === '1'?"Aanwezig":"Afwezig"}}
					</td>
				</tr>
				<tr>
					<td class='b'>Vrijdag</td>
					<td>
						{{(modal.child.meta.present_fri||[])[0] === '1'?"Aanwezig":"Afwezig"}}
					</td>
				</tr>
			</table>
			<button ion-button full (click)="closeModal();" class="bg-green correction">Ok</button>
			<button ion-button full (click)="scanChild(modal.child.meta.WooCommerceEventsTicketID[0])"
				class="bg-yellow correction">Scan</button>
			<button ion-button full (click)="goHome()" class="bg-red correction">Terug naar homepagina</button>
		</div>
	</div>
</ion-content>
